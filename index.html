<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<style>
.text-container {
  width: 20em;
  height: 20em;
  border: 1px solid #ccc;
  font-family: "Noto Serif JP", "Yu Mincho", serif;
  font-size: 20px;
  line-height: 1.2;
  padding: 10px;
  display: flex;
  flex-direction: row-reverse; /* Right to left columns */
  align-items: flex-start;
  gap: 2em;
  overflow-x: auto;
  background: white;
}

.column {
  white-space: pre-line;
  min-width: 5em;
  text-align: left;
}

textarea {
  position: absolute;
  left: -9999px;
  opacity: 0;
}
</style>
</head>
<body>
<p>試しに書いてください:</p>
<div class="text-container" id="display"></div>
<textarea id="hiddenInput"></textarea>

<script>
const hiddenInput = document.getElementById('hiddenInput');
const display = document.getElementById('display');

function updateDisplay() {
  const text = hiddenInput.value;
  const columns = text.split('　'); // Split by full-width space (Enter key)
  
  display.innerHTML = '';
  
  columns.forEach((columnText, index) => {
    if (columnText.trim() || index === columns.length - 1) {
      const columnDiv = document.createElement('div');
      columnDiv.className = 'column';
      columnDiv.textContent = columnText;
      display.appendChild(columnDiv);
    }
  });
  
  // Keep focus on hidden textarea
  hiddenInput.focus();
}

hiddenInput.addEventListener('keydown', function(e) {
  if (e.key === ' ') {
    // Spacebar: move to next row (insert newline)
    e.preventDefault();
    const start = this.selectionStart;
    const end = this.selectionEnd;
    this.value = this.value.substring(0, start) + '\n' + this.value.substring(end);
    this.selectionStart = this.selectionEnd = start + 1;
  } else if (e.key === 'Enter') {
    // Enter: create new column
    e.preventDefault();
    const start = this.selectionStart;
    const end = this.selectionEnd;
    this.value = this.value.substring(0, start) + '　' + this.value.substring(end);
    this.selectionStart = this.selectionEnd = start + 1;
  }
});

hiddenInput.addEventListener('input', updateDisplay);
hiddenInput.addEventListener('keyup', updateDisplay);

// Initialize
hiddenInput.focus();
updateDisplay();

// Keep focus on the hidden input
display.addEventListener('click', () => {
  hiddenInput.focus();
});
</script>
</body>
</html>